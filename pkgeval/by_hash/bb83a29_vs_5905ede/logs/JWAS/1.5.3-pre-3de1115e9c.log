Current time is 2020-10-25T23:31:48.56
Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 

Starting installation at 2020-10-25T23:31:51.746
  Resolving package versions...
  Installed Rmath_jll ──────────────────── v0.2.2+1
  Installed Compat ─────────────────────── v3.22.0
  Installed SentinelArrays ─────────────── v1.2.16
  Installed StatsFuns ──────────────────── v0.9.5
  Installed Parsers ────────────────────── v1.0.11
  Installed StructTypes ────────────────── v1.1.0
  Installed Distributions ──────────────── v0.24.1
  Installed JWAS ───────────────────────── v0.9.1
  Installed PooledArrays ───────────────── v0.5.3
  Installed InvertedIndices ────────────── v1.0.0
  Installed CompilerSupportLibraries_jll ─ v0.3.4+0
  Installed OpenSpecFun_jll ────────────── v0.5.3+4
  Installed SortingAlgorithms ──────────── v0.3.1
  Installed OrderedCollections ─────────── v1.3.1
  Installed SpecialFunctions ───────────── v0.10.3
  Installed JLLWrappers ────────────────── v1.1.3
  Installed CategoricalArrays ──────────── v0.8.3
  Installed DataFrames ─────────────────── v0.21.8
  Installed DataStructures ─────────────── v0.18.8
  Installed Rmath ──────────────────────── v0.6.1
  Installed IteratorInterfaceExtensions ── v1.0.0
  Installed PDMats ─────────────────────── v0.10.1
  Installed DataValueInterfaces ────────── v1.0.0
  Installed Tables ─────────────────────── v1.1.0
  Installed Reexport ───────────────────── v0.2.0
  Installed TableTraits ────────────────── v1.0.0
  Installed QuadGK ─────────────────────── v2.4.1
  Installed Missings ───────────────────── v0.4.4
  Installed StaticArrays ───────────────── v0.12.4
  Installed JSON ───────────────────────── v0.21.1
  Installed StatsBase ──────────────────── v0.33.2
  Installed Artifacts ──────────────────── v1.3.0
  Installed ProgressMeter ──────────────── v1.4.0
  Installed FillArrays ─────────────────── v0.9.7
  Installed DataAPI ────────────────────── v1.3.0
  Installed CSV ────────────────────────── v0.7.7
Updating `~/.julia/environments/v1.5/Project.toml`
  [c9a035f4] + JWAS v0.9.1
Updating `~/.julia/environments/v1.5/Manifest.toml`
  [56f22d72] + Artifacts v1.3.0
  [336ed68f] + CSV v0.7.7
  [324d7699] + CategoricalArrays v0.8.3
  [34da2185] + Compat v3.22.0
  [e66e0078] + CompilerSupportLibraries_jll v0.3.4+0
  [9a962f9c] + DataAPI v1.3.0
  [a93c6f00] + DataFrames v0.21.8
  [864edb3b] + DataStructures v0.18.8
  [e2d170a0] + DataValueInterfaces v1.0.0
  [31c24e10] + Distributions v0.24.1
  [1a297f60] + FillArrays v0.9.7
  [41ab1584] + InvertedIndices v1.0.0
  [82899510] + IteratorInterfaceExtensions v1.0.0
  [692b3bcd] + JLLWrappers v1.1.3
  [682c06a0] + JSON v0.21.1
  [c9a035f4] + JWAS v0.9.1
  [e1d29d7a] + Missings v0.4.4
  [efe28fd5] + OpenSpecFun_jll v0.5.3+4
  [bac558e1] + OrderedCollections v1.3.1
  [90014a1f] + PDMats v0.10.1
  [69de0a69] + Parsers v1.0.11
  [2dfb63ee] + PooledArrays v0.5.3
  [92933f4c] + ProgressMeter v1.4.0
  [1fd47b50] + QuadGK v2.4.1
  [189a3867] + Reexport v0.2.0
  [79098fc4] + Rmath v0.6.1
  [f50d1b31] + Rmath_jll v0.2.2+1
  [91c51154] + SentinelArrays v1.2.16
  [a2af1166] + SortingAlgorithms v0.3.1
  [276daf66] + SpecialFunctions v0.10.3
  [90137ffa] + StaticArrays v0.12.4
  [2913bbd2] + StatsBase v0.33.2
  [4c63d2b9] + StatsFuns v0.9.5
  [856f2bd8] + StructTypes v1.1.0
  [3783bdb8] + TableTraits v1.0.0
  [bd369af6] + Tables v1.1.0
  [2a0f44e3] + Base64
  [ade2ca70] + Dates
  [8bb1440f] + DelimitedFiles
  [8ba89e20] + Distributed
  [9fa8497b] + Future
  [b77e0a4c] + InteractiveUtils
  [76f85450] + LibGit2
  [8f399da3] + Libdl
  [37e2e46d] + LinearAlgebra
  [56ddb016] + Logging
  [d6f4376e] + Markdown
  [a63ad114] + Mmap
  [44cfe95a] + Pkg
  [de0858da] + Printf
  [3fa0cd96] + REPL
  [9a3f8284] + Random
  [ea8e919c] + SHA
  [9e88b42a] + Serialization
  [1a1011a3] + SharedArrays
  [6462fe0b] + Sockets
  [2f01184e] + SparseArrays
  [10745b16] + Statistics
  [4607b0f0] + SuiteSparse
  [8dfed614] + Test
  [cf7118a7] + UUIDs
  [4ec0a83e] + Unicode
Starting tests at 2020-10-25T23:31:58.047
    Testing JWAS
Status `/tmp/jl_Tau7G0/Project.toml`
  [336ed68f] CSV v0.7.7
  [a93c6f00] DataFrames v0.21.8
  [31c24e10] Distributions v0.24.1
  [c9a035f4] JWAS v0.9.1
  [92933f4c] ProgressMeter v1.4.0
  [2913bbd2] StatsBase v0.33.2
  [8bb1440f] DelimitedFiles
  [b77e0a4c] InteractiveUtils
  [37e2e46d] LinearAlgebra
  [de0858da] Printf
  [9a3f8284] Random
  [2f01184e] SparseArrays
  [8dfed614] Test
Status `/tmp/jl_Tau7G0/Manifest.toml`
  [56f22d72] Artifacts v1.3.0
  [336ed68f] CSV v0.7.7
  [324d7699] CategoricalArrays v0.8.3
  [34da2185] Compat v3.22.0
  [e66e0078] CompilerSupportLibraries_jll v0.3.4+0
  [9a962f9c] DataAPI v1.3.0
  [a93c6f00] DataFrames v0.21.8
  [864edb3b] DataStructures v0.18.8
  [e2d170a0] DataValueInterfaces v1.0.0
  [31c24e10] Distributions v0.24.1
  [1a297f60] FillArrays v0.9.7
  [41ab1584] InvertedIndices v1.0.0
  [82899510] IteratorInterfaceExtensions v1.0.0
  [692b3bcd] JLLWrappers v1.1.3
  [682c06a0] JSON v0.21.1
  [c9a035f4] JWAS v0.9.1
  [e1d29d7a] Missings v0.4.4
  [efe28fd5] OpenSpecFun_jll v0.5.3+4
  [bac558e1] OrderedCollections v1.3.1
  [90014a1f] PDMats v0.10.1
  [69de0a69] Parsers v1.0.11
  [2dfb63ee] PooledArrays v0.5.3
  [92933f4c] ProgressMeter v1.4.0
  [1fd47b50] QuadGK v2.4.1
  [189a3867] Reexport v0.2.0
  [79098fc4] Rmath v0.6.1
  [f50d1b31] Rmath_jll v0.2.2+1
  [91c51154] SentinelArrays v1.2.16
  [a2af1166] SortingAlgorithms v0.3.1
  [276daf66] SpecialFunctions v0.10.3
  [90137ffa] StaticArrays v0.12.4
  [2913bbd2] StatsBase v0.33.2
  [4c63d2b9] StatsFuns v0.9.5
  [856f2bd8] StructTypes v1.1.0
  [3783bdb8] TableTraits v1.0.0
  [bd369af6] Tables v1.1.0
  [2a0f44e3] Base64
  [ade2ca70] Dates
  [8bb1440f] DelimitedFiles
  [8ba89e20] Distributed
  [9fa8497b] Future
  [b77e0a4c] InteractiveUtils
  [76f85450] LibGit2
  [8f399da3] Libdl
  [37e2e46d] LinearAlgebra
  [56ddb016] Logging
  [d6f4376e] Markdown
  [a63ad114] Mmap
  [44cfe95a] Pkg
  [de0858da] Printf
  [3fa0cd96] REPL
  [9a3f8284] Random
  [ea8e919c] SHA
  [9e88b42a] Serialization
  [1a1011a3] SharedArrays
  [6462fe0b] Sockets
  [2f01184e] SparseArrays
  [10745b16] Statistics
  [4607b0f0] SuiteSparse
  [8dfed614] Test
  [cf7118a7] UUIDs
  [4ec0a83e] Unicode
┌ Warning: `CSV.read(input; kw...)` is deprecated in favor of `using DataFrames; CSV.read(input, DataFrame; kw...)
│   caller = ip:0x0
└ @ Core :-1
The delimiter in pedigree.txt is ','.
calculating inbreeding...   8%|██▏                      |  ETA: 0:00:02[Kcalculating inbreeding... 100%|█████████████████████████| Time: 0:00:00[K
Pedigree informatin:
#individuals: 12
#sires:       4
#dams:        5
#founders:    3








Test single-trait BayesA analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
BayesA is equivalent to BayesB with known π=0. BayesB with known π=0 runs.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                    false
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ...  1%|▍                                  |  ETA: 0:03:00[Krunning MCMC ...  2%|▊                                  |  ETA: 0:01:38[Krunning MCMC ... 10%|███▌                               |  ETA: 0:00:34[K
Posterior means at iteration: 50
Residual variance: 0.42648

Posterior means at iteration: 100
Residual variance: 0.602628
running MCMC ...100%|███████████████████████████████████| Time: 0:00:03[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.24529        │ 0.238795  │ 14.36    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.928484       │ 1.87052   │ 27.85    │ 1.0     │ 1.0      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.449918       │ 0.851585  │ 43.72    │ 0.9     │ 0.966667 │,)







Test multi-trait BayesA analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
BayesA is equivalent to BayesB with known π=0. BayesB with known π=0 runs.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam + geno
y2 = intercept + x1 + x2 + x3 + ID + geno
y3 = intercept + x1 + x1*x3 + x2 + ID + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                    false
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ...  1%|▍                                  |  ETA: 0:06:19[Krunning MCMC ...  2%|▊                                  |  ETA: 0:03:36[Krunning MCMC ... 10%|███▌                               |  ETA: 0:00:46[K
Posterior means at iteration: 50
Residual variance: [1.048305 0.24503 0.587471; 0.24503 0.905183 0.301719; 0.587471 0.301719 0.810604]
running MCMC ... 50%|█████████████████▌                 |  ETA: 0:00:05[K
Posterior means at iteration: 100
Residual variance: [0.985218 0.333494 0.563598; 0.333494 0.819621 0.313252; 0.563598 0.313252 0.819117]
running MCMC ...100%|███████████████████████████████████| Time: 0:00:05[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
calculating genomic correlation... 10%|█▊               |  ETA: 0:00:01[Kcalculating genomic correlation...100%|█████████████████| Time: 0:00:00[K
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.645567       │ 0.559104  │ 44.69    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.178435       │ 0.161819  │ 13.69    │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.354085       │ 0.388771  │ 33.21    │ 1.0     │ 1.0     │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.693424       │ 0.601019  │ 52.38    │ 1.0     │ 1.0      │
│ 2   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0941799      │ 0.0660242 │ 18.71    │ 0.9     │ 0.95     │
│ 3   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.701378       │ 0.776142  │ 38.63    │ 0.9     │ 0.933333 │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.248152     │ 0.447913 │ 0.254101     │ 0.766391 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0434972    │ 0.108688 │ 0.2          │ 1.0328   │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.329352     │ 0.321206 │ 0.647639     │ 0.550764 │)







Test single-trait BayesB analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: 0.651794

Posterior means at iteration: 100
Residual variance: 0.728344


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.6            │
│ 2   │ m2        │ 0.7            │
│ 3   │ m3        │ 0.8            │
│ 4   │ m4        │ 0.8            │
│ 5   │ m5        │ 0.6            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.26583        │ 0.301093  │ 42.04    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.454581       │ 0.979017  │ 49.18    │ 0.7     │ 0.85    │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.329148       │ 0.498201  │ 32.67    │ 0.7     │ 0.8     │,)







Test multi-trait BayesB analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam + geno
y2 = intercept + x1 + x2 + x3 + ID + geno
y3 = intercept + x1 + x1*x3 + x2 + ID + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ...  1%|▍                                  |  ETA: 0:01:09[K
Posterior means at iteration: 50
Residual variance: [1.626752 0.263321 0.897374; 0.263321 0.986433 0.459563; 0.897374 0.459563 0.918263]

Posterior means at iteration: 100
Residual variance: [1.159283 0.321964 0.670119; 0.321964 0.783316 0.367481; 0.670119 0.367481 0.879995]
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.6            │
│ 2   │ m2        │ 0.9            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 0.6            │
│ 5   │ m5        │ 0.5            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.870179       │ 0.979063  │ 62.05    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.259719       │ 0.308742  │ 20.91    │ 0.9     │ 0.95    │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.150441       │ 0.194417  │ 10.02    │ 0.8     │ 0.9     │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.26716        │ 0.352185  │ 35.18    │ 0.7     │ 0.7      │
│ 2   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0876395      │ 0.139486  │ 19.01    │ 0.6     │ 0.65     │
│ 3   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.235254       │ 0.582551  │ 18.95    │ 0.4     │ 0.566667 │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0569879    │ 0.116845 │ 0.277281     │ 0.632103 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.297178    │ 0.640611 │ -0.3         │ 0.674949 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0186287    │ 0.185047 │ -0.195534    │ 0.589601 │)







Test single-trait BayesC analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesC
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: 3.057062

Posterior means at iteration: 100
Residual variance: 1.870018


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.6            │
│ 2   │ m2        │ 0.7            │
│ 3   │ m3        │ 0.5            │
│ 4   │ m4        │ 0.8            │
│ 5   │ m5        │ 0.3            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.639478       │ 1.69251   │ 54.84    │ 0.7     │ 0.7      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.115934       │ 0.192889  │ 46.02    │ 0.7     │ 0.7      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.750166       │ 1.82737   │ 36.79    │ 0.5     │ 0.633333 │,)







Test multi-trait BayesC analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam + geno
y2 = intercept + x1 + x2 + x3 + ID + geno
y3 = intercept + x1 + x1*x3 + x2 + ID + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesC
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ...  1%|▍                                  |  ETA: 0:00:15[K
Posterior means at iteration: 50
Residual variance: [2.564318 0.464896 0.444278; 0.464896 0.815238 -0.128444; 0.444278 -0.128444 0.506211]

Posterior means at iteration: 100
Residual variance: [1.679025 0.351114 0.336657; 0.351114 0.683915 0.046108; 0.336657 0.046108 0.497956]
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.5            │
│ 2   │ m2        │ 0.6            │
│ 3   │ m3        │ 0.6            │
│ 4   │ m4        │ 0.5            │
│ 5   │ m5        │ 0.5            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.29637        │ 0.320257  │ 47.34    │ 0.8     │ 0.8      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0679117      │ 0.120646  │ 20.47    │ 0.8     │ 0.8      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.107061       │ 0.192977  │ 23.3     │ 0.4     │ 0.666667 │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.148094       │ 0.293095  │ 20.6     │ 0.7     │ 0.7     │
│ 2   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.221994       │ 0.295639  │ 41.02    │ 0.7     │ 0.7     │
│ 3   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0665255      │ 0.133245  │ 19.89    │ 0.4     │ 0.6     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov   │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64   │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼───────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.102103     │ 0.282098  │ 0.170671     │ 0.307232 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.00924177  │ 0.0307305 │ 0.1          │ 0.567646 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0525245    │ 0.166332  │ 0.0854346    │ 0.670623 │)







Test single-trait RR-BLUP analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                      RR-BLUP
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ...  1%|▍                                  |  ETA: 0:00:10[K
Posterior means at iteration: 50
Residual variance: 0.849846

Posterior means at iteration: 100
Residual variance: 0.804558
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 3.99782        │ 7.51353   │ 36.82    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.859016       │ 1.14844   │ 42.76    │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 1.66728        │ 2.44538   │ 20.84    │ 1.0     │ 1.0     │,)







Test multi-trait RR-BLUP analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam + geno
y2 = intercept + x1 + x2 + x3 + ID + geno
y3 = intercept + x1 + x1*x3 + x2 + ID + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                      RR-BLUP
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ...  1%|▍                                  |  ETA: 0:00:30[Krunning MCMC ...  2%|▊                                  |  ETA: 0:00:20[K
Posterior means at iteration: 50
Residual variance: [1.044053 -0.127823 0.233645; -0.127823 0.687915 0.285315; 0.233645 0.285315 0.561695]

Posterior means at iteration: 100
Residual variance: [0.929812 0.009563 0.180148; 0.009563 0.860924 0.393622; 0.180148 0.393622 0.556803]
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.974089       │ 1.27612   │ 45.28    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.668967       │ 0.921185  │ 23.99    │ 1.0     │ 1.0      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.303215       │ 0.252019  │ 17.66    │ 0.9     │ 0.966667 │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.311335       │ 0.233347  │ 80.59    │ 1.0     │ 1.0     │
│ 2   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.238621       │ 0.337218  │ 32.82    │ 1.0     │ 1.0     │
│ 3   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.362163       │ 0.399797  │ 107.54   │ 1.0     │ 1.0     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ -0.170628    │ 0.434762 │ -0.114139    │ 0.760457 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.0680065   │ 0.260281 │ -2.22045e-17 │ 1.05409  │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.176558     │ 0.288703 │ 0.501848     │ 0.700527 │)







Test single-trait BayesL analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesL
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ...  1%|▍                                  |  ETA: 0:01:12[K
Posterior means at iteration: 50
Residual variance: 1.358352

Posterior means at iteration: 100
Residual variance: 0.874413
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 4.45992        │ 7.93169   │ 70.81    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 1.1774         │ 1.85822   │ 31.8     │ 1.0     │ 1.0      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 2.5174         │ 4.76222   │ 40.16    │ 0.9     │ 0.966667 │,)







Test multi-trait BayesL analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam + geno
y2 = intercept + x1 + x2 + x3 + ID + geno
y3 = intercept + x1 + x1*x3 + x2 + ID + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesL
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ...  1%|▍                                  |  ETA: 0:00:42[K
Posterior means at iteration: 50
Residual variance: [0.692505 0.32009 0.356; 0.32009 1.040073 0.135197; 0.356 0.135197 0.584003]

Posterior means at iteration: 100
Residual variance: [1.15207 1.159312 0.435045; 1.159312 2.302848 0.578089; 0.435045 0.578089 0.712442]
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 8.79338        │ 9.36545   │ 76.37    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 8.07195        │ 7.48268   │ 64.78    │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 1.69087        │ 2.39837   │ 13.46    │ 1.0     │ 1.0     │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 21.3359        │ 16.8921   │ 81.52    │ 1.0     │ 1.0     │
│ 2   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 1.77227        │ 2.77351   │ 9.4      │ 1.0     │ 1.0     │
│ 3   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 7.01443        │ 11.3002   │ 30.62    │ 1.0     │ 1.0     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64 │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼─────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 10.2757      │ 12.0118 │ 0.360977     │ 0.922777 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -2.37952     │ 2.79921 │ -0.6         │ 0.843274 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ -0.390585    │ 4.25976 │ -0.204877    │ 0.802174 │)







Test single-trait GBLUP analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                        GBLUP
genetic variances (genomic):                  1.000
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ...  1%|▍                                  |  ETA: 0:00:35[Krunning MCMC ...  2%|▊                                  |  ETA: 0:00:30[K
Posterior means at iteration: 50
Residual variance: 2.164281

Posterior means at iteration: 100
Residual variance: 2.162909
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.










Test multi-trait GBLUP analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam + geno
y2 = intercept + x1 + x2 + x3 + ID + geno
y3 = intercept + x1 + x1*x3 + x2 + ID + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                        GBLUP
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ...  1%|▍                                  |  ETA: 0:01:15[Krunning MCMC ...  2%|▊                                  |  ETA: 0:00:43[K
Posterior means at iteration: 50
Residual variance: [1.234058 0.552677 0.60126; 0.552677 0.931698 0.484262; 0.60126 0.484262 0.888541]

Posterior means at iteration: 100
Residual variance: [1.69146 1.032109 0.908741; 1.032109 1.45271 0.967732; 0.908741 0.967732 1.375875]
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.










Test single-trait conventional (no markers) analysis using complete genomic data


The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:


Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: 0.747599

Posterior means at iteration: 100
Residual variance: 1.167932


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.










Test multi-trait conventional (no markers) analysis using complete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:


Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: [1.327766 0.583734 0.691153; 0.583734 0.799378 0.461235; 0.691153 0.461235 0.940878]

Posterior means at iteration: 100
Residual variance: [2.653166 0.307565 0.635272; 0.307565 1.183735 0.339602; 0.635272 0.339602 0.787332]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.










Test single-trait BayesA analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
BayesA is equivalent to BayesB with known π=0. BayesB with known π=0 runs.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.159242 seconds (79.54 k allocations: 4.022 MiB)
imputing missing genotypes
  2.364352 seconds (2.32 M allocations: 124.985 MiB, 16.13% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
random effect variances (y1:ϵ):                [1.0]
genetic variances (polygenic):
 1.0f0  0.5f0
 0.5f0  1.0f0
residual variances:                           1.000

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                    false
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_y1.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
running MCMC ...  1%|▍                                  |  ETA: 0:01:15[Krunning MCMC ...  2%|▊                                  |  ETA: 0:00:50[Krunning MCMC ... 10%|███▌                               |  ETA: 0:00:18[Krunning MCMC ... 20%|███████                            |  ETA: 0:00:09[K
Posterior means at iteration: 50
Residual variance: 4.42659

Posterior means at iteration: 100
Residual variance: 3.766127
running MCMC ...100%|███████████████████████████████████| Time: 0:00:02[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.390282       │ 0.389329  │ 81.99    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.451025       │ 0.793988  │ 47.5     │ 1.0     │ 1.0      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.597797       │ 1.24221   │ 37.59    │ 0.9     │ 0.966667 │,)







Test multi-trait BayesA analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
BayesA is equivalent to BayesB with known π=0. BayesB with known π=0 runs.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000066 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.154924 seconds (314 allocations: 32.266 KiB, 99.65% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam + geno
y2 = intercept + x1 + x2 + x3 + ID + geno
y3 = intercept + x1 + x1*x3 + x2 + ID + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
random effect variances (y1:ϵ,y2:ϵ,y3:ϵ):
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                    false
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
random effect variances:                      7.000
polygenic effect variances:                   8.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y2.J.txt is created to save MCMC samples for y2:J.
The file results/MCMC_samples_y3.J.txt is created to save MCMC samples for y3:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y2.ϵ.txt is created to save MCMC samples for y2:ϵ.
The file results/MCMC_samples_y3.ϵ.txt is created to save MCMC samples for y3:ϵ.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_y1.ϵ_y2.ϵ_y3.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_y2:ϵ_y3:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
running MCMC ...  2%|▊                                  |  ETA: 0:00:08[K
Posterior means at iteration: 50
Residual variance: [3.940506 -2.523397 -0.831471; -2.523397 3.064282 1.312228; -0.831471 1.312228 1.078996]
running MCMC ... 93%|████████████████████████████████▌  |  ETA: 0:00:00[K
Posterior means at iteration: 100
Residual variance: [3.634313 -2.460016 -0.827119; -2.460016 3.401824 1.352251; -0.827119 1.352251 0.925681]
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.335944       │ 0.373987  │ 45.47    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.287861       │ 0.455937  │ 27.72    │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.298572       │ 0.46272   │ 49.89    │ 1.0     │ 1.0     │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.391561       │ 0.323681  │ 69.6     │ 1.0     │ 1.0     │
│ 2   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.164767       │ 0.127141  │ 32.97    │ 1.0     │ 1.0     │
│ 3   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.286688       │ 0.336803  │ 41.85    │ 1.0     │ 1.0     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.220517     │ 0.298374 │ 0.389574     │ 0.474391 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.146329     │ 0.250257 │ 0.6          │ 0.843274 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.132837     │ 0.240087 │ 0.460173     │ 0.738233 │)







Test single-trait BayesB analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000044 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.144043 seconds (314 allocations: 32.266 KiB, 99.84% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
random effect variances (y1:ϵ):                [1.0]
genetic variances (polygenic):
 1.0f0  0.5f0
 0.5f0  1.0f0
residual variances:                           1.000

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_y1.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
running MCMC ...  1%|▍                                  |  ETA: 0:00:16[K
Posterior means at iteration: 50
Residual variance: 1.462335

Posterior means at iteration: 100
Residual variance: 2.516479
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.3            │
│ 2   │ m2        │ 0.3            │
│ 3   │ m3        │ 0.3            │
│ 4   │ m4        │ 0.6            │
│ 5   │ m5        │ 0.5            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.273736       │ 0.804348  │ 48.21    │ 0.7     │ 0.7      │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0136079      │ 0.0308647 │ 33.21    │ 0.3     │ 0.5      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.016645       │ 0.0379978 │ 10.13    │ 0.3     │ 0.433333 │,)







Test multi-trait BayesB analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000048 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.150660 seconds (314 allocations: 32.266 KiB, 99.84% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam + geno
y2 = intercept + x1 + x2 + x3 + ID + geno
y3 = intercept + x1 + x1*x3 + x2 + ID + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
random effect variances (y1:ϵ,y2:ϵ,y3:ϵ):
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
random effect variances:                      7.000
polygenic effect variances:                   8.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y2.J.txt is created to save MCMC samples for y2:J.
The file results/MCMC_samples_y3.J.txt is created to save MCMC samples for y3:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y2.ϵ.txt is created to save MCMC samples for y2:ϵ.
The file results/MCMC_samples_y3.ϵ.txt is created to save MCMC samples for y3:ϵ.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_y1.ϵ_y2.ϵ_y3.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_y2:ϵ_y3:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.

Posterior means at iteration: 50
Residual variance: [1.465106 -1.073411 -0.1851; -1.073411 2.514484 1.259614; -0.1851 1.259614 1.340282]
running MCMC ... 97%|██████████████████████████████████ |  ETA: 0:00:00[K
Posterior means at iteration: 100
Residual variance: [3.225426 -1.705939 -0.454517; -1.705939 2.463054 1.010839; -0.454517 1.010839 1.016126]
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.5            │
│ 2   │ m2        │ 0.5            │
│ 3   │ m3        │ 0.7            │
│ 4   │ m4        │ 0.4            │
│ 5   │ m5        │ 0.2            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.659379       │ 1.14082   │ 44.68    │ 0.7     │ 0.7      │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0590248      │ 0.0760614 │ 32.21    │ 0.5     │ 0.6      │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0652188      │ 0.0940045 │ 7.27     │ 0.5     │ 0.566667 │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar  │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64    │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼────────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.121815       │ 0.161151   │ 44.14    │ 0.6     │ 0.6     │
│ 2   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.167655       │ 0.198031   │ 40.66    │ 0.5     │ 0.55    │
│ 3   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.000825877    │ 0.00261165 │ 0.4      │ 0.1     │ 0.4     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov     │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64     │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼─────────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ -0.0242992   │ 0.0716755   │ -0.0970506   │ 0.27429  │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.000283265 │ 0.000895761 │ -0.1         │ 0.316228 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0431896    │ 0.100283    │ 0.13124      │ 0.477829 │)







Test single-trait BayesC analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000051 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.142492 seconds (314 allocations: 32.266 KiB, 99.82% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
random effect variances (y1:ϵ):                [1.0]
genetic variances (polygenic):
 1.0f0  0.5f0
 0.5f0  1.0f0
residual variances:                           1.000

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesC
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_y1.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.

Posterior means at iteration: 50
Residual variance: 0.891731

Posterior means at iteration: 100
Residual variance: 0.909185


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.3            │
│ 2   │ m2        │ 0.5            │
│ 3   │ m3        │ 0.5            │
│ 4   │ m4        │ 0.4            │
│ 5   │ m5        │ 0.5            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0158428      │ 0.0200135 │ 28.83    │ 0.7     │ 0.7     │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0394809      │ 0.0747728 │ 28.39    │ 0.6     │ 0.65    │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0494394      │ 0.0725417 │ 23.57    │ 0.5     │ 0.6     │,)







Test multi-trait BayesC analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000049 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.144775 seconds (314 allocations: 32.266 KiB, 99.84% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam + geno
y2 = intercept + x1 + x2 + x3 + ID + geno
y3 = intercept + x1 + x1*x3 + x2 + ID + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
random effect variances (y1:ϵ,y2:ϵ,y3:ϵ):
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesC
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
random effect variances:                      7.000
polygenic effect variances:                   8.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y2.J.txt is created to save MCMC samples for y2:J.
The file results/MCMC_samples_y3.J.txt is created to save MCMC samples for y3:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y2.ϵ.txt is created to save MCMC samples for y2:ϵ.
The file results/MCMC_samples_y3.ϵ.txt is created to save MCMC samples for y3:ϵ.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_y1.ϵ_y2.ϵ_y3.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_y2:ϵ_y3:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.

Posterior means at iteration: 50
Residual variance: [3.864974 -3.39905 -1.640315; -3.39905 4.675147 2.127744; -1.640315 2.127744 1.629643]

Posterior means at iteration: 100
Residual variance: [2.923368 -2.58082 -1.067851; -2.58082 5.024812 2.068501; -1.067851 2.068501 1.318797]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.3            │
│ 2   │ m2        │ 0.7            │
│ 3   │ m3        │ 0.8            │
│ 4   │ m4        │ 0.5            │
│ 5   │ m5        │ 0.6            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.402068       │ 0.793618  │ 37.3     │ 0.8     │ 0.8      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.361477       │ 0.752976  │ 62.49    │ 0.8     │ 0.8      │
│ 3   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.150169       │ 0.166616  │ 39.31    │ 0.7     │ 0.766667 │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.166961       │ 0.205435  │ 105.41   │ 0.8     │ 0.8     │
│ 2   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0714629      │ 0.0729152 │ 71.17    │ 0.8     │ 0.8     │
│ 3   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0196227      │ 0.0387602 │ 29.51    │ 0.5     │ 0.7     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0478868    │ 0.13311  │ -0.020004    │ 0.640692 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0409683    │ 0.139261 │ 0.1          │ 0.737865 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.12696      │ 0.182338 │ 0.643138     │ 0.47137  │)







Test single-trait RR-BLUP analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000049 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.149626 seconds (314 allocations: 32.266 KiB, 99.84% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
random effect variances (y1:ϵ):                [1.0]
genetic variances (polygenic):
 1.0f0  0.5f0
 0.5f0  1.0f0
residual variances:                           1.000

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                      RR-BLUP
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_y1.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
running MCMC ...  2%|▊                                  |  ETA: 0:00:06[K
Posterior means at iteration: 50
Residual variance: 3.08925

Posterior means at iteration: 100
Residual variance: 2.340042
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.568276       │ 0.949296  │ 79.25    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.370579       │ 0.83927   │ 29.72    │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.805074       │ 1.40373   │ 109.14   │ 1.0     │ 1.0     │,)







Test multi-trait RR-BLUP analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000054 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.143094 seconds (314 allocations: 32.266 KiB, 99.83% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam + geno
y2 = intercept + x1 + x2 + x3 + ID + geno
y3 = intercept + x1 + x1*x3 + x2 + ID + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
random effect variances (y1:ϵ,y2:ϵ,y3:ϵ):
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                      RR-BLUP
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
random effect variances:                      7.000
polygenic effect variances:                   8.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y2.J.txt is created to save MCMC samples for y2:J.
The file results/MCMC_samples_y3.J.txt is created to save MCMC samples for y3:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y2.ϵ.txt is created to save MCMC samples for y2:ϵ.
The file results/MCMC_samples_y3.ϵ.txt is created to save MCMC samples for y3:ϵ.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_y1.ϵ_y2.ϵ_y3.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_y2:ϵ_y3:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.

Posterior means at iteration: 50
Residual variance: [3.243578 -1.812104 0.039974; -1.812104 2.234631 0.340865; 0.039974 0.340865 0.466138]

Posterior means at iteration: 100
Residual variance: [3.839302 -2.421915 -0.122939; -2.421915 2.618782 0.427373; -0.122939 0.427373 0.494716]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.301448       │ 0.312151  │ 101.99   │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.73558        │ 1.30678   │ 66.5     │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.850164       │ 1.53844   │ 75.06    │ 1.0     │ 1.0     │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.170057       │ 0.187382  │ 83.25    │ 1.0     │ 1.0     │
│ 2   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.117448       │ 0.321517  │ 20.15    │ 1.0     │ 1.0     │
│ 3   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.207595       │ 0.273969  │ 80.6     │ 1.0     │ 1.0     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0709881    │ 0.143983 │ 0.23615      │ 0.807482 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.0275587   │ 0.170481 │ 0.2          │ 1.0328   │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.265337     │ 0.602568 │ 0.52198      │ 0.6614   │)







Test single-trait BayesL analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000042 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.140900 seconds (314 allocations: 32.266 KiB, 99.84% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
random effect variances (y1:ϵ):                [1.0]
genetic variances (polygenic):
 1.0f0  0.5f0
 0.5f0  1.0f0
residual variances:                           1.000

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesL
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_y1.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
running MCMC ...  1%|▍                                  |  ETA: 0:00:39[K
Posterior means at iteration: 50
Residual variance: 1.555116

Posterior means at iteration: 100
Residual variance: 1.243914
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 35.8848        │ 55.2884   │ 82.07    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 1.23343        │ 2.15445   │ 36.2     │ 0.9     │ 0.95     │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.394252       │ 0.509877  │ 15.57    │ 0.9     │ 0.933333 │,)







Test multi-trait BayesL analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000048 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.188662 seconds (314 allocations: 32.266 KiB, 99.88% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam + geno
y2 = intercept + x1 + x2 + x3 + ID + geno
y3 = intercept + x1 + x1*x3 + x2 + ID + geno

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
random effect variances (y1:ϵ,y2:ϵ,y3:ϵ):
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesL
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
random effect variances:                      7.000
polygenic effect variances:                   8.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y2.J.txt is created to save MCMC samples for y2:J.
The file results/MCMC_samples_y3.J.txt is created to save MCMC samples for y3:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y2.ϵ.txt is created to save MCMC samples for y2:ϵ.
The file results/MCMC_samples_y3.ϵ.txt is created to save MCMC samples for y3:ϵ.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_y1.ϵ_y2.ϵ_y3.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_y2:ϵ_y3:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.

Posterior means at iteration: 50
Residual variance: [1.041776 -0.491455 -0.339372; -0.491455 1.402854 0.705999; -0.339372 0.705999 1.098964]

Posterior means at iteration: 100
Residual variance: [0.78741 -0.041625 0.032377; -0.041625 1.328367 0.716969; 0.032377 0.716969 1.065456]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 6.85037        │ 6.68266   │ 26.75    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 32.1058        │ 24.4366   │ 132.31   │ 1.0     │ 1.0      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.924093       │ 1.40617   │ 17.36    │ 0.6     │ 0.866667 │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 25.9667        │ 11.8592   │ 172.45   │ 1.0     │ 1.0      │
│ 2   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 6.51209        │ 5.89734   │ 41.7     │ 0.9     │ 0.95     │
│ 3   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.233989       │ 0.324194  │ 2.25     │ 0.9     │ 0.933333 │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ -6.28462     │ 5.90183  │ -0.751472    │ 0.466769 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.291732    │ 0.457129 │ -0.8         │ 0.632456 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ -27.3897     │ 18.0348  │ -0.934696    │ 0.151432 │)







Test single-trait GBLUP analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7








Test multi-trait GBLUP analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.








Test single-trait conventional (no markers) analysis using incomplete genomic data










Test multi-trait conventional (no markers) analysis using incomplete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.








Test single-trait BayesA analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
BayesA is equivalent to BayesB with known π=0. BayesB with known π=0 runs.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                    false
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: 0.42648

Posterior means at iteration: 100
Residual variance: 0.602628


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.24529        │ 0.238795  │ 14.36    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.928484       │ 1.87052   │ 27.85    │ 1.0     │ 1.0      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.449918       │ 0.851585  │ 43.72    │ 0.9     │ 0.966667 │,)







Test multi-trait BayesA analysis using complete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
BayesA is equivalent to BayesB with known π=0. BayesB with known π=0 runs.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                    false
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      7.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ... 11%|███▉                               |  ETA: 0:00:01[K
Posterior means at iteration: 50
Residual variance: [1.048305 0.24503 0.587471; 0.24503 0.905183 0.301719; 0.587471 0.301719 0.810604]

Posterior means at iteration: 100
Residual variance: [0.985218 0.333494 0.563598; 0.333494 0.819621 0.313252; 0.563598 0.313252 0.819117]
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.645567       │ 0.559104  │ 44.69    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.178435       │ 0.161819  │ 13.69    │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.354085       │ 0.388771  │ 33.21    │ 1.0     │ 1.0     │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.693424       │ 0.601019  │ 52.38    │ 1.0     │ 1.0      │
│ 2   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0941799      │ 0.0660242 │ 18.71    │ 0.9     │ 0.95     │
│ 3   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.701378       │ 0.776142  │ 38.63    │ 0.9     │ 0.933333 │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.248152     │ 0.447913 │ 0.254101     │ 0.766391 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0434972    │ 0.108688 │ 0.2          │ 1.0328   │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.329352     │ 0.321206 │ 0.647639     │ 0.550764 │)







Test single-trait BayesB analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: 0.651794

Posterior means at iteration: 100
Residual variance: 0.728344


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.6            │
│ 2   │ m2        │ 0.7            │
│ 3   │ m3        │ 0.8            │
│ 4   │ m4        │ 0.8            │
│ 5   │ m5        │ 0.6            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.26583        │ 0.301093  │ 42.04    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.454581       │ 0.979017  │ 49.18    │ 0.7     │ 0.85    │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.329148       │ 0.498201  │ 32.67    │ 0.7     │ 0.8     │,)







Test multi-trait BayesB analysis using complete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      7.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: [1.626752 0.263321 0.897374; 0.263321 0.986433 0.459563; 0.897374 0.459563 0.918263]

Posterior means at iteration: 100
Residual variance: [1.159283 0.321964 0.670119; 0.321964 0.783316 0.367481; 0.670119 0.367481 0.879995]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.6            │
│ 2   │ m2        │ 0.9            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 0.6            │
│ 5   │ m5        │ 0.5            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.870179       │ 0.979063  │ 62.05    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.259719       │ 0.308742  │ 20.91    │ 0.9     │ 0.95    │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.150441       │ 0.194417  │ 10.02    │ 0.8     │ 0.9     │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.26716        │ 0.352185  │ 35.18    │ 0.7     │ 0.7      │
│ 2   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0876395      │ 0.139486  │ 19.01    │ 0.6     │ 0.65     │
│ 3   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.235254       │ 0.582551  │ 18.95    │ 0.4     │ 0.566667 │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0569879    │ 0.116845 │ 0.277281     │ 0.632103 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.297178    │ 0.640611 │ -0.3         │ 0.674949 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0186287    │ 0.185047 │ -0.195534    │ 0.589601 │)







Test single-trait BayesC analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesC
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: 3.057062

Posterior means at iteration: 100
Residual variance: 1.870018


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.6            │
│ 2   │ m2        │ 0.7            │
│ 3   │ m3        │ 0.5            │
│ 4   │ m4        │ 0.8            │
│ 5   │ m5        │ 0.3            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.639478       │ 1.69251   │ 54.84    │ 0.7     │ 0.7      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.115934       │ 0.192889  │ 46.02    │ 0.7     │ 0.7      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.750166       │ 1.82737   │ 36.79    │ 0.5     │ 0.633333 │,)







Test multi-trait BayesC analysis using complete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesC
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      7.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: [2.564318 0.464896 0.444278; 0.464896 0.815238 -0.128444; 0.444278 -0.128444 0.506211]
running MCMC ... 62%|█████████████████████▊             |  ETA: 0:00:00[K
Posterior means at iteration: 100
Residual variance: [1.679025 0.351114 0.336657; 0.351114 0.683915 0.046108; 0.336657 0.046108 0.497956]
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.5            │
│ 2   │ m2        │ 0.6            │
│ 3   │ m3        │ 0.6            │
│ 4   │ m4        │ 0.5            │
│ 5   │ m5        │ 0.5            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.29637        │ 0.320257  │ 47.34    │ 0.8     │ 0.8      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0679117      │ 0.120646  │ 20.47    │ 0.8     │ 0.8      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.107061       │ 0.192977  │ 23.3     │ 0.4     │ 0.666667 │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.148094       │ 0.293095  │ 20.6     │ 0.7     │ 0.7     │
│ 2   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.221994       │ 0.295639  │ 41.02    │ 0.7     │ 0.7     │
│ 3   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0665255      │ 0.133245  │ 19.89    │ 0.4     │ 0.6     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov   │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64   │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼───────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.102103     │ 0.282098  │ 0.170671     │ 0.307232 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.00924177  │ 0.0307305 │ 0.1          │ 0.567646 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0525245    │ 0.166332  │ 0.0854346    │ 0.670623 │)







Test single-trait RR-BLUP analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                      RR-BLUP
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: 0.849846

Posterior means at iteration: 100
Residual variance: 0.804558


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 3.99782        │ 7.51353   │ 36.82    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.859016       │ 1.14844   │ 42.76    │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 1.66728        │ 2.44538   │ 20.84    │ 1.0     │ 1.0     │,)







Test multi-trait RR-BLUP analysis using complete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                      RR-BLUP
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      7.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: [1.044053 -0.127823 0.233645; -0.127823 0.687915 0.285315; 0.233645 0.285315 0.561695]

Posterior means at iteration: 100
Residual variance: [0.929812 0.009563 0.180148; 0.009563 0.860924 0.393622; 0.180148 0.393622 0.556803]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.974089       │ 1.27612   │ 45.28    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.668967       │ 0.921185  │ 23.99    │ 1.0     │ 1.0      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.303215       │ 0.252019  │ 17.66    │ 0.9     │ 0.966667 │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.311335       │ 0.233347  │ 80.59    │ 1.0     │ 1.0     │
│ 2   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.238621       │ 0.337218  │ 32.82    │ 1.0     │ 1.0     │
│ 3   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.362163       │ 0.399797  │ 107.54   │ 1.0     │ 1.0     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ -0.170628    │ 0.434762 │ -0.114139    │ 0.760457 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.0680065   │ 0.260281 │ -2.22045e-17 │ 1.05409  │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.176558     │ 0.288703 │ 0.501848     │ 0.700527 │)







Test single-trait BayesL analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesL
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: 1.358352

Posterior means at iteration: 100
Residual variance: 0.874413


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 4.45992        │ 7.93169   │ 70.81    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 1.1774         │ 1.85822   │ 31.8     │ 1.0     │ 1.0      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 2.5174         │ 4.76222   │ 40.16    │ 0.9     │ 0.966667 │,)







Test multi-trait BayesL analysis using complete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                       BayesL
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      7.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.
running MCMC ... 23%|████████                           |  ETA: 0:00:00[K
Posterior means at iteration: 50
Residual variance: [0.692505 0.32009 0.356; 0.32009 1.040073 0.135197; 0.356 0.135197 0.584003]

Posterior means at iteration: 100
Residual variance: [1.15207 1.159312 0.435045; 1.159312 2.302848 0.578089; 0.435045 0.578089 0.712442]
running MCMC ...100%|███████████████████████████████████| Time: 0:00:00[K


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 8.79338        │ 9.36545   │ 76.37    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 8.07195        │ 7.48268   │ 64.78    │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 1.69087        │ 2.39837   │ 13.46    │ 1.0     │ 1.0     │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 21.3359        │ 16.8921   │ 81.52    │ 1.0     │ 1.0     │
│ 2   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 1.77227        │ 2.77351   │ 9.4      │ 1.0     │ 1.0     │
│ 3   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 7.01443        │ 11.3002   │ 30.62    │ 1.0     │ 1.0     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64 │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼─────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 10.2757      │ 12.0118 │ 0.360977     │ 0.922777 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -2.37952     │ 2.79921 │ -0.6         │ 0.843274 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ -0.390585    │ 4.25976 │ -0.204877    │ 0.802174 │)







Test single-trait GBLUP analysis using complete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                        GBLUP
genetic variances (genomic):                  1.000
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: 2.164281

Posterior means at iteration: 100
Residual variance: 2.162909


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.










Test multi-trait GBLUP analysis using complete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both genotypes and phenotypes used in the analysis is 4.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

complete genomic data (i.e., non-single-step analysis)

Genomic Category                               geno
Method                                        GBLUP
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000
marker effect variances:                      7.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: [1.234058 0.552677 0.60126; 0.552677 0.931698 0.484262; 0.60126 0.484262 0.888541]

Posterior means at iteration: 100
Residual variance: [1.69146 1.032109 0.908741; 1.032109 1.45271 0.967732; 0.908741 0.967732 1.375875]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.










Test single-trait conventional (no markers) analysis using complete genomic data


The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
genetic variances (polygenic):
 1.0  0.5
 0.5  1.0
residual variances:                           1.000

Genomic Information:


Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
polygenic effect variances:                   6.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: 0.747599

Posterior means at iteration: 100
Residual variance: 1.167932


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.










Test multi-trait conventional (no markers) analysis using complete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
Phenotypes for all traits included in the model for individual a7 in the row 5 are missing. This record is deleted.
The number of observations with both phenotype and pedigree information used in the analysis is 4.
Missing values are found in independent variables: dam.

A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:


Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
polygenic effect variances:                   8.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.
The file results/MCMC_samples_genetic_variance.txt is created to save MCMC samples for genetic_variance.
The file results/MCMC_samples_heritability.txt is created to save MCMC samples for heritability.

Posterior means at iteration: 50
Residual variance: [1.327766 0.583734 0.691153; 0.583734 0.799378 0.461235; 0.691153 0.461235 0.940878]

Posterior means at iteration: 100
Residual variance: [2.653166 0.307565 0.635272; 0.307565 1.183735 0.339602; 0.635272 0.339602 0.787332]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.










Test single-trait BayesA analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
BayesA is equivalent to BayesB with known π=0. BayesB with known π=0 runs.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000066 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.146373 seconds (314 allocations: 32.266 KiB, 99.84% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
random effect variances (y1:ϵ):                [1.0]
genetic variances (polygenic):
 1.0f0  0.5f0
 0.5f0  1.0f0
residual variances:                           1.000

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                    false
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_y1.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.

Posterior means at iteration: 50
Residual variance: 4.42659

Posterior means at iteration: 100
Residual variance: 3.766127


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.390282       │ 0.389329  │ 81.99    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.451025       │ 0.793988  │ 47.5     │ 1.0     │ 1.0      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.597797       │ 1.24221   │ 37.59    │ 0.9     │ 0.966667 │,)







Test multi-trait BayesA analysis using incomplete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
BayesA is equivalent to BayesB with known π=0. BayesB with known π=0 runs.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000066 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.143265 seconds (314 allocations: 32.266 KiB, 99.82% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
random effect variances (y1:ϵ,y2:ϵ,y3:ϵ):
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                    false
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
random effect variances:                      7.000
polygenic effect variances:                   8.000
marker effect variances:                      7.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y2.J.txt is created to save MCMC samples for y2:J.
The file results/MCMC_samples_y3.J.txt is created to save MCMC samples for y3:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y2.ϵ.txt is created to save MCMC samples for y2:ϵ.
The file results/MCMC_samples_y3.ϵ.txt is created to save MCMC samples for y3:ϵ.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_y1.ϵ_y2.ϵ_y3.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_y2:ϵ_y3:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.

Posterior means at iteration: 50
Residual variance: [3.940506 -2.523397 -0.831471; -2.523397 3.064282 1.312228; -0.831471 1.312228 1.078996]

Posterior means at iteration: 100
Residual variance: [3.634313 -2.460016 -0.827119; -2.460016 3.401824 1.352251; -0.827119 1.352251 0.925681]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.335944       │ 0.373987  │ 45.47    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.287861       │ 0.455937  │ 27.72    │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.298572       │ 0.46272   │ 49.89    │ 1.0     │ 1.0     │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.391561       │ 0.323681  │ 69.6     │ 1.0     │ 1.0     │
│ 2   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.164767       │ 0.127141  │ 32.97    │ 1.0     │ 1.0     │
│ 3   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.286688       │ 0.336803  │ 41.85    │ 1.0     │ 1.0     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.220517     │ 0.298374 │ 0.389574     │ 0.474391 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.146329     │ 0.250257 │ 0.6          │ 0.843274 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.132837     │ 0.240087 │ 0.460173     │ 0.738233 │)







Test single-trait BayesB analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000056 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.144914 seconds (314 allocations: 32.266 KiB, 99.85% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
random effect variances (y1:ϵ):                [1.0]
genetic variances (polygenic):
 1.0f0  0.5f0
 0.5f0  1.0f0
residual variances:                           1.000

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_y1.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.

Posterior means at iteration: 50
Residual variance: 1.462335

Posterior means at iteration: 100
Residual variance: 2.516479


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.3            │
│ 2   │ m2        │ 0.3            │
│ 3   │ m3        │ 0.3            │
│ 4   │ m4        │ 0.6            │
│ 5   │ m5        │ 0.5            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.273736       │ 0.804348  │ 48.21    │ 0.7     │ 0.7      │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0136079      │ 0.0308647 │ 33.21    │ 0.3     │ 0.5      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.016645       │ 0.0379978 │ 10.13    │ 0.3     │ 0.433333 │,)







Test multi-trait BayesB analysis using incomplete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000052 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.165366 seconds (314 allocations: 32.266 KiB, 99.86% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
random effect variances (y1:ϵ,y2:ϵ,y3:ϵ):
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesB
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
random effect variances:                      7.000
polygenic effect variances:                   8.000
marker effect variances:                      7.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y2.J.txt is created to save MCMC samples for y2:J.
The file results/MCMC_samples_y3.J.txt is created to save MCMC samples for y3:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y2.ϵ.txt is created to save MCMC samples for y2:ϵ.
The file results/MCMC_samples_y3.ϵ.txt is created to save MCMC samples for y3:ϵ.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_y1.ϵ_y2.ϵ_y3.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_y2:ϵ_y3:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.

Posterior means at iteration: 50
Residual variance: [1.465106 -1.073411 -0.1851; -1.073411 2.514484 1.259614; -0.1851 1.259614 1.340282]

Posterior means at iteration: 100
Residual variance: [3.225426 -1.705939 -0.454517; -1.705939 2.463054 1.010839; -0.454517 1.010839 1.016126]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.5            │
│ 2   │ m2        │ 0.5            │
│ 3   │ m3        │ 0.7            │
│ 4   │ m4        │ 0.4            │
│ 5   │ m5        │ 0.2            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.659379       │ 1.14082   │ 44.68    │ 0.7     │ 0.7      │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0590248      │ 0.0760614 │ 32.21    │ 0.5     │ 0.6      │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0652188      │ 0.0940045 │ 7.27     │ 0.5     │ 0.566667 │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar  │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64    │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼────────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.121815       │ 0.161151   │ 44.14    │ 0.6     │ 0.6     │
│ 2   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.167655       │ 0.198031   │ 40.66    │ 0.5     │ 0.55    │
│ 3   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.000825877    │ 0.00261165 │ 0.4      │ 0.1     │ 0.4     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov     │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64     │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼─────────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ -0.0242992   │ 0.0716755   │ -0.0970506   │ 0.27429  │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.000283265 │ 0.000895761 │ -0.1         │ 0.316228 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0431896    │ 0.100283    │ 0.13124      │ 0.477829 │)







Test single-trait BayesC analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000065 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.161143 seconds (314 allocations: 32.266 KiB, 99.85% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
random effect variances (y1:ϵ):                [1.0]
genetic variances (polygenic):
 1.0f0  0.5f0
 0.5f0  1.0f0
residual variances:                           1.000

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesC
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
π                                               0.0
estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_y1.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.

Posterior means at iteration: 50
Residual variance: 0.891731

Posterior means at iteration: 100
Residual variance: 0.909185


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.3            │
│ 2   │ m2        │ 0.5            │
│ 3   │ m3        │ 0.5            │
│ 4   │ m4        │ 0.4            │
│ 5   │ m5        │ 0.5            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0158428      │ 0.0200135 │ 28.83    │ 0.7     │ 0.7     │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0394809      │ 0.0747728 │ 28.39    │ 0.6     │ 0.65    │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0494394      │ 0.0725417 │ 23.57    │ 0.5     │ 0.6     │,)







Test multi-trait BayesC analysis using incomplete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000066 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.145295 seconds (314 allocations: 32.266 KiB, 99.81% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

Pi (Π) is not provided.
Pi (Π) is generated assuming all markers have effects on all traits.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
random effect variances (y1:ϵ,y2:ϵ,y3:ϵ):
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesC
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492

Π: (Y(yes):included; N(no):excluded)

["y1", "y2", "y3"]         probability
["N", "Y", "Y"]                 0.0
["N", "N", "Y"]                 0.0
["Y", "Y", "N"]                 0.0
["N", "N", "N"]                 0.0
["Y", "N", "N"]                 0.0
["Y", "N", "Y"]                 0.0
["N", "Y", "N"]                 0.0
["Y", "Y", "Y"]                 1.0

estimatePi                                     true
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
random effect variances:                      7.000
polygenic effect variances:                   8.000
marker effect variances:                      7.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y2.J.txt is created to save MCMC samples for y2:J.
The file results/MCMC_samples_y3.J.txt is created to save MCMC samples for y3:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y2.ϵ.txt is created to save MCMC samples for y2:ϵ.
The file results/MCMC_samples_y3.ϵ.txt is created to save MCMC samples for y3:ϵ.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_y1.ϵ_y2.ϵ_y3.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_y2:ϵ_y3:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.

Posterior means at iteration: 50
Residual variance: [3.864974 -3.39905 -1.640315; -3.39905 4.675147 2.127744; -1.640315 2.127744 1.629643]

Posterior means at iteration: 100
Residual variance: [2.923368 -2.58082 -1.067851; -2.58082 5.024812 2.068501; -1.067851 2.068501 1.318797]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 0.3            │
│ 2   │ m2        │ 0.7            │
│ 3   │ m3        │ 0.8            │
│ 4   │ m4        │ 0.5            │
│ 5   │ m5        │ 0.6            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.402068       │ 0.793618  │ 37.3     │ 0.8     │ 0.8      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.361477       │ 0.752976  │ 62.49    │ 0.8     │ 0.8      │
│ 3   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.150169       │ 0.166616  │ 39.31    │ 0.7     │ 0.766667 │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.166961       │ 0.205435  │ 105.41   │ 0.8     │ 0.8     │
│ 2   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.0714629      │ 0.0729152 │ 71.17    │ 0.8     │ 0.8     │
│ 3   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0196227      │ 0.0387602 │ 29.51    │ 0.5     │ 0.7     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0478868    │ 0.13311  │ -0.020004    │ 0.640692 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.0409683    │ 0.139261 │ 0.1          │ 0.737865 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.12696      │ 0.182338 │ 0.643138     │ 0.47137  │)







Test single-trait RR-BLUP analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000057 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.138565 seconds (314 allocations: 32.266 KiB, 99.84% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
random effect variances (y1:ϵ):                [1.0]
genetic variances (polygenic):
 1.0f0  0.5f0
 0.5f0  1.0f0
residual variances:                           1.000

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                      RR-BLUP
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_y1.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.

Posterior means at iteration: 50
Residual variance: 3.08925

Posterior means at iteration: 100
Residual variance: 2.340042


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.568276       │ 0.949296  │ 79.25    │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.370579       │ 0.83927   │ 29.72    │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.805074       │ 1.40373   │ 109.14   │ 1.0     │ 1.0     │,)







Test multi-trait RR-BLUP analysis using incomplete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000053 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.152528 seconds (314 allocations: 32.266 KiB, 99.83% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
random effect variances (y1:ϵ,y2:ϵ,y3:ϵ):
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                      RR-BLUP
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
random effect variances:                      7.000
polygenic effect variances:                   8.000
marker effect variances:                      7.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y2.J.txt is created to save MCMC samples for y2:J.
The file results/MCMC_samples_y3.J.txt is created to save MCMC samples for y3:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y2.ϵ.txt is created to save MCMC samples for y2:ϵ.
The file results/MCMC_samples_y3.ϵ.txt is created to save MCMC samples for y3:ϵ.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_y1.ϵ_y2.ϵ_y3.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_y2:ϵ_y3:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.

Posterior means at iteration: 50
Residual variance: [3.243578 -1.812104 0.039974; -1.812104 2.234631 0.340865; 0.039974 0.340865 0.466138]

Posterior means at iteration: 100
Residual variance: [3.839302 -2.421915 -0.122939; -2.421915 2.618782 0.427373; -0.122939 0.427373 0.494716]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.301448       │ 0.312151  │ 101.99   │ 1.0     │ 1.0     │
│ 2   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.73558        │ 1.30678   │ 66.5     │ 1.0     │ 1.0     │
│ 3   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.850164       │ 1.53844   │ 75.06    │ 1.0     │ 1.0     │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t   │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64 │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼─────────┤
│ 1   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.170057       │ 0.187382  │ 83.25    │ 1.0     │ 1.0     │
│ 2   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.117448       │ 0.321517  │ 20.15    │ 1.0     │ 1.0     │
│ 3   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.207595       │ 0.273969  │ 80.6     │ 1.0     │ 1.0     │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 0.0709881    │ 0.143983 │ 0.23615      │ 0.807482 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.0275587   │ 0.170481 │ 0.2          │ 1.0328   │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 0.265337     │ 0.602568 │ 0.52198      │ 0.6614   │)







Test single-trait BayesL analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000058 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.136490 seconds (314 allocations: 32.266 KiB, 99.83% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects variance is calculated from the genetic variance and π.
The mean of the prior for the marker effects variance is: 0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1*x3 + x2 + x3 + ID + dam

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1*x3           interaction  fixed                2
x2              factor       random               2
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y1:dam):   [1.0 0.5; 0.5 1.0]
random effect variances (y1:x2):                [1.0]
random effect variances (y1:ϵ):                [1.0]
genetic variances (polygenic):
 1.0f0  0.5f0
 0.5f0  1.0f0
residual variances:                           1.000

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesL
genetic variances (genomic):                  1.000
marker effect variances:                      0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           4.000
random effect variances:                      5.000
random effect variances:                      5.000
polygenic effect variances:                   6.000
marker effect variances:                      4.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y1.x2.txt is created to save MCMC samples for y1:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y1.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y1:dam_variances.
The file results/MCMC_samples_y1.x2_variances.txt is created to save MCMC samples for y1:x2_variances.
The file results/MCMC_samples_y1.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.

Posterior means at iteration: 50
Residual variance: 1.555116

Posterior means at iteration: 100
Residual variance: 1.243914


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 35.8848        │ 55.2884   │ 82.07    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 1.23343        │ 2.15445   │ 36.2     │ 0.9     │ 0.95     │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.394252       │ 0.509877  │ 15.57    │ 0.9     │ 0.933333 │,)







Test multi-trait BayesL analysis using incomplete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7
The folder results is created to save results.
Checking phenotypes...
Individual IDs (strings) are provided in the first column of the phenotypic data.
The number of observations with both phenotype and pedigree information used in the analysis is 8.
calculating A inverse
  0.000057 seconds (262 allocations: 18.531 KiB)
imputing missing genotypes
  0.135438 seconds (314 allocations: 32.266 KiB, 99.80% gc time)
completed imputing genotypes
Missing values are found in independent variables: dam.

The prior for marker effects covariance matrix is calculated from genetic covariance matrix and Π.
The mean of the prior for the marker effects covariance matrix is:
 0.492462  0.246231  0.246231
 0.246231  0.492462  0.246231
 0.246231  0.246231  0.492462



A Linear Mixed Model was build using model equations:

y1 = intercept + x1 + x3 + ID + dam
y2 = intercept + x1 + x2 + x3 + ID
y3 = intercept + x1 + x1*x3 + x2 + ID

Model Information:

Term            C/F          F/R            nLevels
intercept       factor       fixed                1
x1              covariate    fixed                1
x3              factor       fixed                2
ID              factor       random              12
dam             factor       random              12
x2              factor       random               2
x1*x3           interaction  fixed                2
ϵ               factor       random               5
J               covariate    fixed                1

MCMC Information:

chain_length                                    100
burnin                                            0
starting_value                                 true
printout_frequency                               50
output_samples_frequency                         10
constraint                                    false
missing_phenotypes                             true
update_priors_frequency                           0
seed                                            314

Hyper-parameters Information:

random effect variances (y1:ID,y2:ID,y3:ID,y1:dam):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
random effect variances (y2:x2,y3:x2):
 1.0  0.5
 0.5  1.0
random effect variances (y1:ϵ,y2:ϵ,y3:ϵ):
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0
genetic variances (polygenic):
 1.0  0.5  0.5  0.5
 0.5  1.0  0.5  0.5
 0.5  0.5  1.0  0.5
 0.5  0.5  0.5  1.0
residual variances:           
 1.0f0  0.5f0  0.5f0
 0.5f0  1.0f0  0.5f0
 0.5f0  0.5f0  1.0f0

Genomic Information:

incomplete genomic data (i.e., single-step analysis)

Genomic Category                               geno
Method                                       BayesL
genetic variances (genomic):  
 1.0  0.5  0.5
 0.5  1.0  0.5
 0.5  0.5  1.0
marker effect variances:      
 0.492  0.246  0.246
 0.246  0.492  0.246
 0.246  0.246  0.492
estimateScale                                 false

Degree of freedom for hyper-parameters:

residual variances:                           7.000
random effect variances:                      6.000
random effect variances:                      7.000
polygenic effect variances:                   8.000
marker effect variances:                      7.000



The file results/MCMC_samples_residual_variance.txt is created to save MCMC samples for residual_variance.
The file results/MCMC_samples_polygenic_effects_variance.txt is created to save MCMC samples for polygenic_effects_variance.
The file results/MCMC_samples_marker_effects_geno_y1.txt is created to save MCMC samples for marker_effects_geno_y1.
The file results/MCMC_samples_marker_effects_geno_y2.txt is created to save MCMC samples for marker_effects_geno_y2.
The file results/MCMC_samples_marker_effects_geno_y3.txt is created to save MCMC samples for marker_effects_geno_y3.
The file results/MCMC_samples_marker_effects_variances_geno.txt is created to save MCMC samples for marker_effects_variances_geno.
The file results/MCMC_samples_pi_geno.txt is created to save MCMC samples for pi_geno.
The file results/MCMC_samples_y2.x2.txt is created to save MCMC samples for y2:x2.
The file results/MCMC_samples_y3.x2.txt is created to save MCMC samples for y3:x2.
The file results/MCMC_samples_y1.J.txt is created to save MCMC samples for y1:J.
The file results/MCMC_samples_y2.J.txt is created to save MCMC samples for y2:J.
The file results/MCMC_samples_y3.J.txt is created to save MCMC samples for y3:J.
The file results/MCMC_samples_y1.ϵ.txt is created to save MCMC samples for y1:ϵ.
The file results/MCMC_samples_y2.ϵ.txt is created to save MCMC samples for y2:ϵ.
The file results/MCMC_samples_y3.ϵ.txt is created to save MCMC samples for y3:ϵ.
The file results/MCMC_samples_y1.ID_y2.ID_y3.ID_y1.dam_variances.txt is created to save MCMC samples for y1:ID_y2:ID_y3:ID_y1:dam_variances.
The file results/MCMC_samples_y2.x2_y3.x2_variances.txt is created to save MCMC samples for y2:x2_y3:x2_variances.
The file results/MCMC_samples_y1.ϵ_y2.ϵ_y3.ϵ_variances.txt is created to save MCMC samples for y1:ϵ_y2:ϵ_y3:ϵ_variances.
The file results/MCMC_samples_EBV_y1.txt is created to save MCMC samples for EBV_y1.
The file results/MCMC_samples_EBV_y2.txt is created to save MCMC samples for EBV_y2.
The file results/MCMC_samples_EBV_y3.txt is created to save MCMC samples for EBV_y3.

Posterior means at iteration: 50
Residual variance: [1.041776 -0.491455 -0.339372; -0.491455 1.402854 0.705999; -0.339372 0.705999 1.098964]

Posterior means at iteration: 100
Residual variance: [0.78741 -0.041625 0.032377; -0.041625 1.328367 0.716969; 0.032377 0.716969 1.065456]


The version of Julia and Platform in use:

Julia Version 1.5.3-pre.13
Commit 3de1115e9c (2020-10-23 21:58 UTC)
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: AMD EPYC 7502 32-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-9.0.1 (ORCJIT, znver2)
Environment:
  JULIA_DEPOT_PATH = ::/usr/local/share/julia
  JULIA_NUM_THREADS = 2
  JULIA_MAX_NUM_PRECOMPILE_FILES = 9223372036854775807
  JULIA_PKG_SERVER = 
  JULIA_PKGEVAL = true
  JULIA_LOAD_PATH = @:/tmp/jl_Tau7G0


The analysis has finished. Results are saved in the returned variable and text files. MCMC samples are saved in text files.


Compute the model frequency for each marker (the probability the marker is included in the model).
5×2 DataFrame
│ Row │ marker_ID │ modelfrequency │
│     │ Abstract… │ Float64        │
├─────┼───────────┼────────────────┤
│ 1   │ m1        │ 1.0            │
│ 2   │ m2        │ 1.0            │
│ 3   │ m3        │ 1.0            │
│ 4   │ m4        │ 1.0            │
│ 5   │ m5        │ 1.0            │
Compute the posterior probability of association of the genomic window that explains more than 0.001 of the total genetic variance.
(3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 1     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 6.85037        │ 6.68266   │ 26.75    │ 1.0     │ 1.0      │
│ 2   │ 1     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 32.1058        │ 24.4366   │ 132.31   │ 1.0     │ 1.0      │
│ 3   │ 1     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.924093       │ 1.40617   │ 17.36    │ 0.6     │ 0.866667 │, 3×13 DataFrame
│ Row │ trait │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimateGenVar │ stdGenVar │ prGenVar │ WPPA    │ PPA_t    │
│     │ Int64 │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64        │ Float64   │ Float64  │ Float64 │ Float64  │
├─────┼───────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼────────────────┼───────────┼──────────┼─────────┼──────────┤
│ 1   │ 2     │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ 25.9667        │ 11.8592   │ 172.45   │ 1.0     │ 1.0      │
│ 2   │ 2     │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ 6.51209        │ 5.89734   │ 41.7     │ 0.9     │ 0.95     │
│ 3   │ 2     │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ 0.233989       │ 0.324194  │ 2.25     │ 0.9     │ 0.933333 │, 3×12 DataFrame
│ Row │ trait      │ window │ chr    │ wStart  │ wEnd    │ start_SNP │ end_SNP │ numSNP │ estimate_cov │ std_cov  │ estimate_cor │ std_cor  │
│     │ String     │ Int64  │ String │ Int64   │ Int64   │ Int64     │ Int64   │ Int64  │ Float64      │ Float64  │ Float64      │ Float64  │
├─────┼────────────┼────────┼────────┼─────────┼─────────┼───────────┼─────────┼────────┼──────────────┼──────────┼──────────────┼──────────┤
│ 1   │ cor(t1,t2) │ 1      │ 1      │ 0       │ 1000000 │ 16977     │ 434311  │ 2      │ -6.28462     │ 5.90183  │ -0.751472    │ 0.466769 │
│ 2   │ cor(t1,t2) │ 2      │ 1      │ 1000000 │ 2000000 │ 1025513   │ 1025513 │ 1      │ -0.291732    │ 0.457129 │ -0.8         │ 0.632456 │
│ 3   │ cor(t1,t2) │ 3      │ 2      │ 0       │ 1000000 │ 70350     │ 101135  │ 2      │ -27.3897     │ 18.0348  │ -0.934696    │ 0.151432 │)







Test single-trait GBLUP analysis using incomplete genomic data


The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7








Test multi-trait GBLUP analysis using incomplete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7








Test single-trait conventional (no markers) analysis using incomplete genomic data










Test multi-trait conventional (no markers) analysis using incomplete genomic data


dam is not found in model equation 2.
dam is not found in model equation 3.
x2 is not found in model equation 1.
┌ Warning: `CSV.read(input; kw...)` is deprecated in favor of `using DataFrames; CSV.read(input, DataFrame; kw...)
│   caller = read(::String) at CSV.jl:40
└ @ CSV ~/.julia/packages/CSV/MKemC/src/CSV.jl:40
load genotype ...

from a text file with a header (marker IDs)
The delimiter in genotypes.txt is ','.
The header (marker IDs) is provided in genotypes.txt.
#markers: 5; #individuals: 7

from a text file without a header (no marker IDs)
The delimiter in genotypes_noheader.txt is ','.
The header (marker IDs) is not provided in genotypes_noheader.txt.
#markers: 5; #individuals: 7

from an Array (matrix) with marker IDs and individual IDs provided
#markers: 5; #individuals: 7

from an Array (matrix) without marker IDs and with individual IDs provided
The marker IDs are set to 1,2,...,#markers
#markers: 5; #individuals: 7

from an Array (matrix) without marker IDs and individual IDs
The marker IDs are set to 1,2,...,#markers
The individual IDs is set to 1,2,...,#observations
#markers: 5; #individuals: 7

from a DataFrame with marker IDs and individual IDs provided
#markers: 5; #individuals: 7
    Testing JWAS tests passed 
Finished at 2020-10-25T23:35:43.167
